<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">


<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calibrating Interval Estimates with Binary Observations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Lecture3-prose_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lecture3-prose_files/libs/quarto-html/quarto.js"></script>
<script src="Lecture3-prose_files/libs/quarto-html/popper.min.js"></script>
<script src="Lecture3-prose_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lecture3-prose_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lecture3-prose_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lecture3-prose_files/libs/quarto-html/quarto-syntax-highlighting-018089954d508eae8a473f0b7f0491f0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lecture3-prose_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lecture3-prose_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lecture3-prose_files/libs/bootstrap/bootstrap-18b480f5ab8b37c32123ceb3263ca564.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>


<style>
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 48px 56px;
      width: 800px;
      background: white;
      overflow: hidden;
    }
    /* Hide Quarto navigation chrome */
    #quarto-sidebar, .sidebar, nav, footer, .nav-footer,
    #quarto-margin-sidebar, .quarto-search, #quarto-header,
    .toc-actions, nav[role="doc-toc"],
    header.quarto-title-block .quarto-title-breadcrumbs { display: none !important; }
    #quarto-content { margin-left: 0 !important; padding-left: 0 !important; }
    .page-columns .content { grid-column: 1 / -1 !important; }
  </style>
</head>
<body>
<section id="from-sampling-to-coin-flip-sums-n-responses." class="level2">
<h2 class="anchored" data-anchor-id="from-sampling-to-coin-flip-sums-n-responses.">From Sampling to Coin Flip Sums: <span class="math inline">\(n\)</span> Responses.</h2>
<p>To find the distribution of a sum <span class="math inline">\(Y_1 + \ldots + Y_n\)</span>, we do the same thing. We start by writing out the joint distribution of <span class="math inline">\(n\)</span> dice rolls. We’re equally likely to roll any sequence of <span class="math inline">\(n\)</span> numbers in <span class="math inline">\(1\ldots m\)</span>. And there are <span class="math inline">\(m^n\)</span> sequences, so the probability is <span class="math inline">\(1/m^n\)</span> for each sequence. Then we add columns for the corresponding responses ‘for free’. And the sums.</p>
<p>Then we marginalize in two steps.</p>
<ol type="1">
<li>Sum over roll sequences leading to the same response sequence <span class="math inline">\(a_1 \ldots a_n\)</span>.</li>
<li>Sum over response sequences leading to the same sum <span class="math inline">\(s=a_1+\ldots+a_n\)</span>.</li>
</ol>
<section id="step-1.-partial-marginalization-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1.-partial-marginalization-1">Step 1. Partial Marginalization</h3>
<p>To sum over roll sequences, we sum over one roll after another. This is exactly like what we did for one response. Except over and over. You can think of this sum ‘inside out.’</p>
<p>Suppose we’re calculating the probability of the response sequence <span class="math inline">\(a_1 \ldots a_n = 0,0,...,0,0\)</span>.</p>
<ol type="1">
<li>We consider any ‘head’ <span class="math inline">\(j_1\ldots j_{n-1}\)</span> where <span class="math inline">\(y_{j_1} \ldots y_{j_{n-1}}=0,0,...0\)</span> and think about choosing the last element. No matter what the head is, there are <span class="math inline">\(m_0\)</span> ways to complete it by choosing <span class="math inline">\(j_{n}\)</span> with <span class="math inline">\(y_{j_n}=0\)</span>.</li>
<li>We repeat with shortened ‘head’ <span class="math inline">\(j_1 \ldots j_{n-2}\)</span> to consider the choice of <span class="math inline">\(j_{n-1}\)</span>. We have <span class="math inline">\(m_0\)</span> choices and our last step tells us that each choice results in <span class="math inline">\(m_0\)</span> call sequences, so there are <span class="math inline">\(m_0^2\)</span> sequences with head <span class="math inline">\(j_1 \ldots j_{n-2}\)</span> ending in <span class="math inline">\(0,0\)</span>.</li>
<li>Repeat <span class="math inline">\(n-2\)</span> more times.</li>
</ol>
<p>What we get is pretty similar to the two-response case. The probability of observing the sequence is determined by the frequency of Yeses and Nos in the population. It’s the <em>product</em> of the frequencies of those responses. For ‘Yes,Yes,…,Yes’ it’s <span class="math inline">\(\theta_1^n\)</span>. For ‘No,No,…,No’ it’s <span class="math inline">\(\theta_0^n\)</span>. And if we have <span class="math inline">\(s\)</span> Yeses and therefore <span class="math inline">\(n-s\)</span> Nos, it’s <span class="math inline">\(\theta_1^s\theta_0^{n-s}\)</span>.</p>
<p>This is, again, the <em>product</em> of the marginal probabilities of those <span class="math inline">\(n\)</span> responses.</p>
<p><span class="math display">\[
\begin{aligned}
\sum_{\substack{j_1 \ldots j_n  \\ y_{j_1} \ldots y_{j_n} = a_1 \ldots a_n}} \frac{1}{m^n}
&amp;= \sum_{\substack{j_1 \ldots j_{n-1} \\ y_{j_1} \ldots y_{j_{n-1}} = a_1 \ldots a_{n-1}}} \sum_{\substack{j_n \\ y_n=a_n}} \frac{1}{m^n} \\
&amp;= \sum_{\substack{j_1 \ldots j_{n-1} \\ y_{j_1} \ldots y_{j_{n-1}} = a_1 \ldots a_{n-1}}} \sum_{\substack{j_n \\ y_n=a_n}} m_{a_n} \times \frac{1}{m^n} \\
&amp;= \sum_{\substack{j_1 \ldots j_{n-2} \\ y_{j_1} \ldots y_{j_{n-2}} = a_1 \ldots a_{n-2}}} \sum_{\substack{j_{n-1} \\ y_n=a_{n-1}}} m_{a_n} \times \frac{1}{m^n} \\
&amp;= \sum_{\substack{j_1 \ldots j_{n-2} \\ y_{j_1} \ldots y_{j_{n-2}} = a_1 \ldots a_{n-2}}} \sum_{\substack{j_{n-1} \\ y_n=a_{n-1}}} m_{a_{n-1}} m_{a_n} \times \frac{1}{m^n} \\
&amp;= m_{a_1} \ldots m_{a_{n}} \times \frac{1}{m^n} \qqtext{after repeating $n-2$ more times} \\
&amp;= \theta_{a_i} \ldots \theta_{a_n} \\
&amp;= \prod_{i:a_i=1} \theta_1 \prod_{i:a_i=0} \theta_0 = \theta_1^{s} \theta_0^{n-s} \qfor s = a_1 + \ldots + a_n
\end{aligned}
\]</span></p>
</section>
<section id="step-2.-full-marginalization-1" class="level3">
<h3 class="anchored" data-anchor-id="step-2.-full-marginalization-1">Step 2. Full Marginalization</h3>
<p>The full marginalization step is a bit trickier. But we can take advantage of our partial marginalization. To calculate the probability that the sum takes on the value <span class="math inline">\(s\)</span>, we order our sum of probabilities thoughtfully. We sum over response sequences <span class="math inline">\(a_1 \ldots a_n\)</span> with <span class="math inline">\(s\)</span> Yeses and <span class="math inline">\(n-s\)</span> Nos. And within that, we sum over calls where we’d hear those responses.</p>
<p>The inner sum we’ve done. That was our partial marginalization. And the outer sum boils down to counting the number of sequences with <span class="math inline">\(s\)</span> Yeses. The probability of all these sequences is the same: <span class="math inline">\(\theta_1^s\theta_0^{n-s}\)</span>. So summing is counting and multiplying. You may have done the counting part in high school in a unit on ‘permutations and combinations’. In any case, that count has a name. It’s spoken ‘<span class="math inline">\(n\)</span> choose <span class="math inline">\(s\)</span>’ and written <span class="math inline">\(\binom{n}{s}\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\sum\limits_{\substack{j_1 \ldots j_n \\ y_{j_1} + \ldots + y_{j_n} = s}} \frac{1}{m^n}
&amp;= \sum\limits_{\substack{a_1 \dots a_n \\ a_1 + \ldots + a_n = s}} \ \ \sum_{\substack{j_1 \ldots j_n \\ y_{j_1} \ldots y_{j_n} = a_1 \ldots a_n}} \frac{1}{m^n} \\
&amp; =\sum\limits_{\substack{a_1 \dots a_n \\ a_1 + \ldots + a_n = s}} \theta_1^{s}\theta_0^{n-s} \\
&amp;= \binom{s}{n} \theta_1^{s} \theta_0^{n-s} \qqtext{ where } \binom{s}{n} = \sum\limits_{\substack{a_1 \dots a_n \\ a_1 + \ldots + a_n = s}} 1
\end{aligned}
\]</span></p>
</section>
<section id="using-r" class="level3">
<h3 class="anchored" data-anchor-id="using-r">Using <strong>R</strong></h3>
<p><span class="math display">\[
P\qty(\sum_{i=1}^n Y_i = s) =  \binom{s}{n} \theta_1^{s}\theta_0^{n-s}
\ \ \text{ where } \ \ \binom{s}{n} \text{ is the number of binary sequences $a_1 \ldots a_n$ summing to $s$.}
\]</span></p>
<p>We don’t actually have to do all this sequence-summing-to-<span class="math inline">\(s\)</span> counting ourselves. The <code>choose</code> function in <strong>R</strong> will do it for us: <span class="math inline">\(\binom{s}{n}\)</span> is <code>choose(n,s)</code>. The <code>dbinom</code> function will give us the whole probability: <span class="math inline">\(\binom{s}{n}\theta_1^s\theta_0^{n-s}\)</span> is <code>dbinom(s, n, theta_1)</code>. And the <code>rbinom</code> function will draw samples from this distribution: <code>rbinom(10000, n, theta_1)</code> gives us 10,000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>theta_1 <span class="ot">=</span> .<span class="dv">7</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">625</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>n, n, theta_1)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">10000</span>, n, theta_1)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span>n,   <span class="at">y=</span>p), <span class="at">color=</span>pollc, <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>S, <span class="at">y=</span><span class="fu">after_stat</span>(prop)), <span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>S[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>],   <span class="at">y=</span><span class="fu">max</span>(p)<span class="sc">*</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">100</span>)), </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color=</span><span class="st">'purple'</span>, <span class="at">alpha=</span>.<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lecture3-prose_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</body>
</html>